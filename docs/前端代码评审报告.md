# å‰ç«¯ä»£ç è¯„å®¡æŠ¥å‘Š

## è¯„å®¡æ¦‚è¿°

**è¯„å®¡èŒƒå›´**: Webç«¯(React)å’Œç§»åŠ¨ç«¯(React Native)å‰ç«¯åº”ç”¨
**æŠ€æœ¯æ ˆ**: React 18, Ant Design, React Native, Expo, Zustand
**è¯„å®¡é‡ç‚¹**: æ¶æ„è®¾è®¡ã€ä»£ç è´¨é‡ã€æ€§èƒ½ä¼˜åŒ–ã€ç”¨æˆ·ä½“éªŒ

## 1. Webç«¯åº”ç”¨è¯„å®¡ (frontend/web/)

### 1.1 æŠ€æœ¯æ ˆåˆ†æ

#### âœ… æŠ€æœ¯é€‰å‹ä¼˜ç‚¹
```json
// package.json ä¾èµ–åˆ†æ
{
  "dependencies": {
    "react": "^18.2.0",           // æœ€æ–°ç¨³å®šç‰ˆReact
    "antd": "^5.4.0",            // æˆç†Ÿçš„UIç»„ä»¶åº“
    "react-router-dom": "^6.10.0", // ç°ä»£è·¯ç”±æ–¹æ¡ˆ
    "zustand": "^5.0.5",         // è½»é‡çº§çŠ¶æ€ç®¡ç†
    "axios": "^1.3.5",           // HTTPå®¢æˆ·ç«¯
    "chart.js": "^4.2.1",        // å›¾è¡¨åº“
    "socket.io-client": "^4.8.1", // å®æ—¶é€šä¿¡
    "dayjs": "^1.11.7"           // è½»é‡çº§æ—¥æœŸåº“
  }
}
```

**ä¼˜ç‚¹åˆ†æ**:
- React 18æä¾›å¹¶å‘ç‰¹æ€§å’Œæ€§èƒ½ä¼˜åŒ–
- Ant Design 5.xæä¾›ç°ä»£åŒ–UIç»„ä»¶
- Zustandè½»é‡çº§çŠ¶æ€ç®¡ç†ï¼Œé¿å…Reduxå¤æ‚æ€§
- Chart.jsæä¾›ä¸°å¯Œçš„æ•°æ®å¯è§†åŒ–èƒ½åŠ›
- Socket.ioæ”¯æŒå®æ—¶æ•°æ®æ›´æ–°

#### âš ï¸ æŠ€æœ¯æ ˆé—®é¢˜
1. **ç¼ºä¹TypeScript**: æ²¡æœ‰ç±»å‹æ£€æŸ¥ï¼Œå®¹æ˜“å‡ºç°è¿è¡Œæ—¶é”™è¯¯
2. **æµ‹è¯•è¦†ç›–ä¸è¶³**: åªæœ‰åŸºç¡€æµ‹è¯•é…ç½®ï¼Œç¼ºä¹ç»„ä»¶æµ‹è¯•
3. **æ„å»ºä¼˜åŒ–**: ç¼ºä¹ä»£ç åˆ†å‰²å’Œæ‡’åŠ è½½é…ç½®

### 1.2 åº”ç”¨æ¶æ„è¯„å®¡

#### âœ… App.js æ¶æ„è®¾è®¡
```javascript
// App.js æ¶æ„åˆ†æ
import { AuthProvider, useAuth } from './contexts/AuthContext';
import { WebSocketProvider } from './contexts/WebSocketContext';

// å—ä¿æŠ¤è·¯ç”±è®¾è®¡åˆç†
const ProtectedRoute = ({ children }) => {
  const { isAuthenticated, loading } = useAuth();
  
  if (loading) {
    return <div>åŠ è½½ä¸­...</div>;
  }
  
  if (!isAuthenticated) {
    return <Navigate to="/login" replace />;
  }
  
  return children;
};

// ä¸»åº”ç”¨ç»„ä»¶ç»“æ„æ¸…æ™°
const AppContent = () => {
  const { isAuthenticated } = useAuth();
  
  return (
    <Router>
      <Layout style={{ minHeight: '100vh' }}>
        {isAuthenticated && <AppHeader />}
        <Layout>
          {isAuthenticated && <AppSidebar />}
          <Layout>
            <Content className="app-content">
              <Routes>
                <Route path="/login" element={<Login />} />
                <Route path="/dashboard" element={
                  <ProtectedRoute><Dashboard /></ProtectedRoute>
                } />
              </Routes>
            </Content>
          </Layout>
        </Layout>
      </Layout>
    </Router>
  );
};
```

**æ¶æ„ä¼˜ç‚¹**:
- Context APIç”¨äºå…¨å±€çŠ¶æ€ç®¡ç†
- è·¯ç”±ä¿æŠ¤æœºåˆ¶å®Œå–„
- å¸ƒå±€ç»„ä»¶åˆ†ç¦»æ¸…æ™°
- æ¡ä»¶æ¸²æŸ“é€»è¾‘åˆç†

#### âš ï¸ æ¶æ„æ”¹è¿›å»ºè®®

1. **è·¯ç”±æ‡’åŠ è½½**
```javascript
// å»ºè®®å®ç°è·¯ç”±æ‡’åŠ è½½
import { lazy, Suspense } from 'react';

const Dashboard = lazy(() => import('./pages/Dashboard'));
const Analytics = lazy(() => import('./pages/Analytics'));
const Resources = lazy(() => import('./pages/Resources'));

// åœ¨è·¯ç”±ä¸­ä½¿ç”¨Suspense
<Route path="/dashboard" element={
  <ProtectedRoute>
    <Suspense fallback={<div>åŠ è½½ä¸­...</div>}>
      <Dashboard />
    </Suspense>
  </ProtectedRoute>
} />
```

2. **é”™è¯¯è¾¹ç•Œ**
```javascript
// å»ºè®®æ·»åŠ é”™è¯¯è¾¹ç•Œç»„ä»¶
class ErrorBoundary extends React.Component {
  constructor(props) {
    super(props);
    this.state = { hasError: false, error: null };
  }

  static getDerivedStateFromError(error) {
    return { hasError: true, error };
  }

  componentDidCatch(error, errorInfo) {
    console.error('Error caught by boundary:', error, errorInfo);
    // å‘é€é”™è¯¯åˆ°ç›‘æ§æœåŠ¡
  }

  render() {
    if (this.state.hasError) {
      return (
        <div className="error-fallback">
          <h2>å‡ºç°äº†ä¸€äº›é—®é¢˜</h2>
          <button onClick={() => this.setState({ hasError: false })}>
            é‡è¯•
          </button>
        </div>
      );
    }

    return this.props.children;
  }
}
```

### 1.3 çŠ¶æ€ç®¡ç†è¯„å®¡

#### âœ… Contextè®¾è®¡åˆ†æ

ä»App.jså¯ä»¥çœ‹å‡ºä½¿ç”¨äº†å¤šä¸ªContext:
- `AuthContext`: è®¤è¯çŠ¶æ€ç®¡ç†
- `WebSocketContext`: WebSocketè¿æ¥ç®¡ç†

**ä¼˜ç‚¹åˆ†æ**:
- èŒè´£åˆ†ç¦»æ¸…æ™°
- é¿å…prop drilling
- æ”¯æŒå®æ—¶æ•°æ®æ›´æ–°

#### ğŸ”§ çŠ¶æ€ç®¡ç†ä¼˜åŒ–å»ºè®®

1. **ZustandçŠ¶æ€ç®¡ç†ä¼˜åŒ–**
```javascript
// å»ºè®®åˆ›å»ºç»Ÿä¸€çš„çŠ¶æ€ç®¡ç†
import { create } from 'zustand';
import { devtools, persist } from 'zustand/middleware';

// ç”¨æˆ·çŠ¶æ€ç®¡ç†
const useAuthStore = create(
  devtools(
    persist(
      (set, get) => ({
        user: null,
        token: null,
        isAuthenticated: false,
        loading: false,
        
        login: async (credentials) => {
          set({ loading: true });
          try {
            const response = await authAPI.login(credentials);
            set({
              user: response.user,
              token: response.token,
              isAuthenticated: true,
              loading: false
            });
          } catch (error) {
            set({ loading: false });
            throw error;
          }
        },
        
        logout: () => {
          set({
            user: null,
            token: null,
            isAuthenticated: false
          });
        }
      }),
      {
        name: 'auth-storage',
        partialize: (state) => ({ 
          token: state.token,
          user: state.user 
        })
      }
    )
  )
);

// åº”ç”¨çŠ¶æ€ç®¡ç†
const useAppStore = create(
  devtools((set, get) => ({
    theme: 'light',
    language: 'zh-CN',
    notifications: [],
    
    setTheme: (theme) => set({ theme }),
    setLanguage: (language) => set({ language }),
    addNotification: (notification) => 
      set((state) => ({
        notifications: [...state.notifications, notification]
      })),
    removeNotification: (id) =>
      set((state) => ({
        notifications: state.notifications.filter(n => n.id !== id)
      }))
  }))
);
```

2. **æ•°æ®ç¼“å­˜ç­–ç•¥**
```javascript
// å»ºè®®å®ç°æ•°æ®ç¼“å­˜
const useDataStore = create(
  devtools((set, get) => ({
    cache: new Map(),
    loading: new Set(),
    
    fetchData: async (key, fetcher, options = {}) => {
      const { force = false, ttl = 5 * 60 * 1000 } = options;
      const state = get();
      
      // æ£€æŸ¥ç¼“å­˜
      if (!force && state.cache.has(key)) {
        const cached = state.cache.get(key);
        if (Date.now() - cached.timestamp < ttl) {
          return cached.data;
        }
      }
      
      // é˜²æ­¢é‡å¤è¯·æ±‚
      if (state.loading.has(key)) {
        return new Promise((resolve) => {
          const checkLoading = () => {
            if (!get().loading.has(key)) {
              resolve(get().cache.get(key)?.data);
            } else {
              setTimeout(checkLoading, 100);
            }
          };
          checkLoading();
        });
      }
      
      // å¼€å§‹åŠ è½½
      set((state) => ({
        loading: new Set([...state.loading, key])
      }));
      
      try {
        const data = await fetcher();
        set((state) => ({
          cache: new Map([
            ...state.cache,
            [key, { data, timestamp: Date.now() }]
          ]),
          loading: new Set([...state.loading].filter(k => k !== key))
        }));
        return data;
      } catch (error) {
        set((state) => ({
          loading: new Set([...state.loading].filter(k => k !== key))
        }));
        throw error;
      }
    }
  }))
);
```

### 1.4 ç»„ä»¶è®¾è®¡è¯„å®¡

#### âœ… ç»„ä»¶æ¶æ„ä¼˜ç‚¹

ä»ç›®å½•ç»“æ„å¯ä»¥çœ‹å‡º:
- `components/layout/`: å¸ƒå±€ç»„ä»¶åˆ†ç¦»
- `pages/`: é¡µé¢ç»„ä»¶ç»„ç»‡
- `contexts/`: ä¸Šä¸‹æ–‡ç®¡ç†

#### ğŸ”§ ç»„ä»¶ä¼˜åŒ–å»ºè®®

1. **ç»„ä»¶å¤ç”¨æ€§å¢å¼º**
```javascript
// å»ºè®®åˆ›å»ºé€šç”¨ç»„ä»¶
// components/common/DataTable.jsx
import { Table, Button, Space } from 'antd';
import { useState, useMemo } from 'react';

const DataTable = ({
  data,
  columns,
  loading = false,
  pagination = true,
  actions = [],
  onRowSelect,
  ...props
}) => {
  const [selectedRows, setSelectedRows] = useState([]);
  
  const rowSelection = useMemo(() => {
    if (!onRowSelect) return undefined;
    
    return {
      selectedRowKeys: selectedRows,
      onChange: (keys, rows) => {
        setSelectedRows(keys);
        onRowSelect(rows);
      }
    };
  }, [selectedRows, onRowSelect]);
  
  const actionColumn = useMemo(() => {
    if (actions.length === 0) return [];
    
    return [{
      title: 'æ“ä½œ',
      key: 'actions',
      render: (_, record) => (
        <Space>
          {actions.map((action, index) => (
            <Button
              key={index}
              type={action.type || 'link'}
              size="small"
              onClick={() => action.onClick(record)}
              disabled={action.disabled?.(record)}
            >
              {action.label}
            </Button>
          ))}
        </Space>
      )
    }];
  }, [actions]);
  
  return (
    <Table
      dataSource={data}
      columns={[...columns, ...actionColumn]}
      loading={loading}
      pagination={pagination}
      rowSelection={rowSelection}
      {...props}
    />
  );
};

export default DataTable;
```

2. **è¡¨å•ç»„ä»¶å°è£…**
```javascript
// components/common/FormBuilder.jsx
import { Form, Input, Select, DatePicker, Button } from 'antd';
import { useMemo } from 'react';

const FormBuilder = ({
  fields,
  onSubmit,
  initialValues,
  loading = false,
  layout = 'vertical'
}) => {
  const [form] = Form.useForm();
  
  const renderField = useMemo(() => (field) => {
    const { type, name, label, rules, options, ...fieldProps } = field;
    
    const getComponent = () => {
      switch (type) {
        case 'text':
        case 'email':
        case 'password':
          return <Input type={type} {...fieldProps} />;
        case 'select':
          return (
            <Select {...fieldProps}>
              {options?.map(option => (
                <Select.Option key={option.value} value={option.value}>
                  {option.label}
                </Select.Option>
              ))}
            </Select>
          );
        case 'date':
          return <DatePicker {...fieldProps} />;
        default:
          return <Input {...fieldProps} />;
      }
    };
    
    return (
      <Form.Item
        key={name}
        name={name}
        label={label}
        rules={rules}
      >
        {getComponent()}
      </Form.Item>
    );
  }, []);
  
  return (
    <Form
      form={form}
      layout={layout}
      initialValues={initialValues}
      onFinish={onSubmit}
    >
      {fields.map(renderField)}
      <Form.Item>
        <Button type="primary" htmlType="submit" loading={loading}>
          æäº¤
        </Button>
      </Form.Item>
    </Form>
  );
};

export default FormBuilder;
```

### 1.5 æ€§èƒ½ä¼˜åŒ–è¯„å®¡

#### âš ï¸ æ€§èƒ½é—®é¢˜åˆ†æ

1. **ç¼ºä¹ä»£ç åˆ†å‰²**
```javascript
// å½“å‰é—®é¢˜ï¼šæ‰€æœ‰ç»„ä»¶éƒ½åœ¨ä¸»bundleä¸­
import Dashboard from './pages/Dashboard';
import Analytics from './pages/Analytics';

// å»ºè®®ï¼šå®ç°ä»£ç åˆ†å‰²
const Dashboard = lazy(() => import('./pages/Dashboard'));
const Analytics = lazy(() => import('./pages/Analytics'));
```

2. **ç»„ä»¶é‡æ¸²æŸ“ä¼˜åŒ–**
```javascript
// å»ºè®®ä½¿ç”¨React.memoå’ŒuseMemoä¼˜åŒ–
import { memo, useMemo, useCallback } from 'react';

const ExpensiveComponent = memo(({ data, onAction }) => {
  const processedData = useMemo(() => {
    return data.map(item => ({
      ...item,
      computed: heavyComputation(item)
    }));
  }, [data]);
  
  const handleAction = useCallback((id) => {
    onAction(id);
  }, [onAction]);
  
  return (
    <div>
      {processedData.map(item => (
        <div key={item.id} onClick={() => handleAction(item.id)}>
          {item.computed}
        </div>
      ))}
    </div>
  );
});
```

#### ğŸ”§ æ€§èƒ½ä¼˜åŒ–å»ºè®®

1. **è™šæ‹Ÿæ»šåŠ¨**
```javascript
// å¯¹äºå¤§æ•°æ®åˆ—è¡¨ï¼Œå»ºè®®ä½¿ç”¨è™šæ‹Ÿæ»šåŠ¨
import { FixedSizeList as List } from 'react-window';

const VirtualizedList = ({ items }) => {
  const Row = ({ index, style }) => (
    <div style={style}>
      {items[index].name}
    </div>
  );
  
  return (
    <List
      height={600}
      itemCount={items.length}
      itemSize={50}
    >
      {Row}
    </List>
  );
};
```

2. **å›¾ç‰‡æ‡’åŠ è½½**
```javascript
// å»ºè®®å®ç°å›¾ç‰‡æ‡’åŠ è½½
import { useState, useRef, useEffect } from 'react';

const LazyImage = ({ src, alt, placeholder }) => {
  const [loaded, setLoaded] = useState(false);
  const [inView, setInView] = useState(false);
  const imgRef = useRef();
  
  useEffect(() => {
    const observer = new IntersectionObserver(
      ([entry]) => {
        if (entry.isIntersecting) {
          setInView(true);
          observer.disconnect();
        }
      },
      { threshold: 0.1 }
    );
    
    if (imgRef.current) {
      observer.observe(imgRef.current);
    }
    
    return () => observer.disconnect();
  }, []);
  
  return (
    <div ref={imgRef}>
      {inView && (
        <img
          src={src}
          alt={alt}
          onLoad={() => setLoaded(true)}
          style={{ opacity: loaded ? 1 : 0 }}
        />
      )}
      {!loaded && placeholder}
    </div>
  );
};
```

## 2. ç§»åŠ¨ç«¯åº”ç”¨è¯„å®¡ (frontend/mobile/)

### 2.1 æŠ€æœ¯æ ˆåˆ†æ

#### âœ… ç§»åŠ¨ç«¯æŠ€æœ¯é€‰å‹
```json
// package.json ä¾èµ–åˆ†æ
{
  "dependencies": {
    "expo": "^50.0.0",                    // Expoå¼€å‘æ¡†æ¶
    "react": "18.2.0",                   // React 18
    "react-native": "0.73.6",            // React Nativeæœ€æ–°ç‰ˆ
    "@react-navigation/native": "^6.1.6", // å¯¼èˆªåº“
    "react-native-paper": "^5.0.0",      // Material Designç»„ä»¶
    "zustand": "^5.0.5",                 // çŠ¶æ€ç®¡ç†
    "axios": "^1.4.0"                    // HTTPå®¢æˆ·ç«¯
  }
}
```

**ä¼˜ç‚¹åˆ†æ**:
- Expoæä¾›å¿«é€Ÿå¼€å‘å’Œéƒ¨ç½²èƒ½åŠ›
- React Navigation 6.xç°ä»£å¯¼èˆªæ–¹æ¡ˆ
- React Native Paperæä¾›Material Designé£æ ¼
- ä¸Webç«¯å…±äº«çŠ¶æ€ç®¡ç†æ–¹æ¡ˆ(Zustand)

#### âš ï¸ ç§»åŠ¨ç«¯æŠ€æœ¯é—®é¢˜
1. **ç¼ºä¹TypeScript**: ç§»åŠ¨ç«¯åŒæ ·ç¼ºä¹ç±»å‹æ£€æŸ¥
2. **æµ‹è¯•é…ç½®**: ç§»åŠ¨ç«¯æµ‹è¯•é…ç½®ç›¸å¯¹ç®€å•
3. **æ€§èƒ½ç›‘æ§**: ç¼ºä¹ç§»åŠ¨ç«¯æ€§èƒ½ç›‘æ§

### 2.2 ç§»åŠ¨ç«¯æ¶æ„è¯„å®¡

#### âœ… App.jsæ¶æ„åˆ†æ
```javascript
// App.js ç§»åŠ¨ç«¯æ¶æ„
import { AuthContext } from './src/contexts/AuthContext';
import { NetworkProvider, useNetwork } from './src/contexts/NetworkContext';

// ç¦»çº¿æ¨¡å¼æ”¯æŒ
const OfflineBanner = () => {
  const { isOfflineMode } = useNetwork();
  
  if (!isOfflineMode) return null;
  
  return (
    <View style={styles.offlineBanner}>
      <Text style={styles.offlineText}>ç¦»çº¿æ¨¡å¼ - éƒ¨åˆ†åŠŸèƒ½å¯èƒ½å—é™</Text>
    </View>
  );
};

// è§’è‰²å¯¼èˆªå™¨é€‰æ‹©
const getNavigatorByRole = (role) => {
  switch (role) {
    case USER_ROLES.PARENT:
      return ParentNavigator;
    case USER_ROLES.STUDENT:
      return StudentNavigator;
    case USER_ROLES.TEACHER:
    default:
      return MainAppNavigator;
  }
};
```

**æ¶æ„ä¼˜ç‚¹**:
- æ”¯æŒç¦»çº¿æ¨¡å¼
- å¤šè§’è‰²å¯¼èˆªå™¨è®¾è®¡
- ç½‘ç»œçŠ¶æ€ç®¡ç†
- è§’è‰²é€‰æ‹©æœºåˆ¶

#### ğŸ”§ ç§»åŠ¨ç«¯æ¶æ„ä¼˜åŒ–

1. **å¯¼èˆªä¼˜åŒ–**
```javascript
// å»ºè®®ä¼˜åŒ–å¯¼èˆªæ€§èƒ½
import { createNativeStackNavigator } from '@react-navigation/native-stack';
import { createBottomTabNavigator } from '@react-navigation/bottom-tabs';

// ä½¿ç”¨åŸç”Ÿå¯¼èˆªå™¨æå‡æ€§èƒ½
const Stack = createNativeStackNavigator();
const Tab = createBottomTabNavigator();

// é¢„åŠ è½½å…³é”®å±å¹•
const preloadScreens = {
  Dashboard: () => import('./screens/Dashboard'),
  Profile: () => import('./screens/Profile')
};

// å¯¼èˆªæ€§èƒ½ä¼˜åŒ–
const NavigationContainer = ({ children }) => {
  return (
    <NavigationContainer
      onReady={() => {
        // é¢„åŠ è½½å…³é”®å±å¹•
        Object.values(preloadScreens).forEach(loader => loader());
      }}
    >
      {children}
    </NavigationContainer>
  );
};
```

2. **çŠ¶æ€æŒä¹…åŒ–**
```javascript
// å»ºè®®å®ç°çŠ¶æ€æŒä¹…åŒ–
import AsyncStorage from '@react-native-async-storage/async-storage';

const persistConfig = {
  key: 'root',
  storage: AsyncStorage,
  whitelist: ['auth', 'settings', 'cache']
};

// ç¦»çº¿æ•°æ®åŒæ­¥
const useOfflineSync = () => {
  const [pendingActions, setPendingActions] = useState([]);
  const { isOnline } = useNetwork();
  
  const addPendingAction = useCallback((action) => {
    setPendingActions(prev => [...prev, {
      ...action,
      timestamp: Date.now(),
      id: Math.random().toString(36)
    }]);
  }, []);
  
  useEffect(() => {
    if (isOnline && pendingActions.length > 0) {
      // åŒæ­¥ç¦»çº¿æ“ä½œ
      syncPendingActions(pendingActions)
        .then(() => setPendingActions([]))
        .catch(console.error);
    }
  }, [isOnline, pendingActions]);
  
  return { addPendingAction, pendingActions };
};
```

### 2.3 ç§»åŠ¨ç«¯æ€§èƒ½ä¼˜åŒ–

#### ğŸ”§ æ€§èƒ½ä¼˜åŒ–å»ºè®®

1. **å›¾ç‰‡ä¼˜åŒ–**
```javascript
// å»ºè®®å®ç°å›¾ç‰‡ç¼“å­˜å’Œä¼˜åŒ–
import { Image } from 'expo-image';

const OptimizedImage = ({ source, style, ...props }) => {
  return (
    <Image
      source={source}
      style={style}
      cachePolicy="memory-disk"
      transition={200}
      {...props}
    />
  );
};

// å›¾ç‰‡é¢„åŠ è½½
const preloadImages = async (imageUrls) => {
  const promises = imageUrls.map(url => 
    Image.prefetch(url)
  );
  await Promise.all(promises);
};
```

2. **åˆ—è¡¨æ€§èƒ½ä¼˜åŒ–**
```javascript
// ä½¿ç”¨FlatListä¼˜åŒ–é•¿åˆ—è¡¨
import { FlatList, VirtualizedList } from 'react-native';

const OptimizedList = ({ data, renderItem }) => {
  const getItemLayout = useCallback((data, index) => ({
    length: ITEM_HEIGHT,
    offset: ITEM_HEIGHT * index,
    index
  }), []);
  
  const keyExtractor = useCallback((item) => item.id, []);
  
  return (
    <FlatList
      data={data}
      renderItem={renderItem}
      keyExtractor={keyExtractor}
      getItemLayout={getItemLayout}
      removeClippedSubviews={true}
      maxToRenderPerBatch={10}
      windowSize={10}
      initialNumToRender={10}
    />
  );
};
```

3. **å†…å­˜ç®¡ç†**
```javascript
// å»ºè®®å®ç°å†…å­˜ç®¡ç†
const useMemoryWarning = () => {
  useEffect(() => {
    const subscription = AppState.addEventListener('memoryWarning', () => {
      // æ¸…ç†ç¼“å­˜
      clearImageCache();
      // æ¸…ç†ä¸å¿…è¦çš„çŠ¶æ€
      clearNonEssentialData();
    });
    
    return () => subscription?.remove();
  }, []);
};
```

### 2.4 ç”¨æˆ·ä½“éªŒä¼˜åŒ–

#### ğŸ”§ UXä¼˜åŒ–å»ºè®®

1. **åŠ è½½çŠ¶æ€ç®¡ç†**
```javascript
// å»ºè®®å®ç°ç»Ÿä¸€çš„åŠ è½½çŠ¶æ€
const LoadingProvider = ({ children }) => {
  const [loadingStates, setLoadingStates] = useState(new Map());
  
  const setLoading = useCallback((key, loading) => {
    setLoadingStates(prev => new Map(prev.set(key, loading)));
  }, []);
  
  const isLoading = useCallback((key) => {
    return loadingStates.get(key) || false;
  }, [loadingStates]);
  
  const isAnyLoading = useMemo(() => {
    return Array.from(loadingStates.values()).some(Boolean);
  }, [loadingStates]);
  
  return (
    <LoadingContext.Provider value={{ setLoading, isLoading, isAnyLoading }}>
      {children}
      {isAnyLoading && <GlobalLoadingIndicator />}
    </LoadingContext.Provider>
  );
};
```

2. **é”™è¯¯å¤„ç†**
```javascript
// å»ºè®®å®ç°å‹å¥½çš„é”™è¯¯å¤„ç†
const ErrorBoundary = ({ children }) => {
  const [hasError, setHasError] = useState(false);
  const [error, setError] = useState(null);
  
  useEffect(() => {
    const errorHandler = (error, isFatal) => {
      setHasError(true);
      setError(error);
      
      // å‘é€é”™è¯¯æŠ¥å‘Š
      crashlytics().recordError(error);
    };
    
    ErrorUtils.setGlobalHandler(errorHandler);
  }, []);
  
  if (hasError) {
    return (
      <View style={styles.errorContainer}>
        <Text style={styles.errorTitle}>å‡ºç°äº†é—®é¢˜</Text>
        <Text style={styles.errorMessage}>
          {error?.message || 'æœªçŸ¥é”™è¯¯'}
        </Text>
        <Button
          title="é‡è¯•"
          onPress={() => {
            setHasError(false);
            setError(null);
          }}
        />
      </View>
    );
  }
  
  return children;
};
```

## 3. è·¨å¹³å°ä»£ç å¤ç”¨

### 3.1 å…±äº«é€»è¾‘æŠ½å–

#### ğŸ”§ å»ºè®®å®ç°å…±äº«Hook
```javascript
// shared/hooks/useAuth.js
import { useCallback } from 'react';
import { useAuthStore } from '../stores/authStore';

export const useAuth = () => {
  const {
    user,
    token,
    isAuthenticated,
    loading,
    login: loginAction,
    logout: logoutAction
  } = useAuthStore();
  
  const login = useCallback(async (credentials) => {
    try {
      await loginAction(credentials);
      // å¹³å°ç‰¹å®šçš„ç™»å½•åå¤„ç†
      if (Platform.OS === 'web') {
        // Webç«¯å¤„ç†
        localStorage.setItem('lastLogin', Date.now());
      } else {
        // ç§»åŠ¨ç«¯å¤„ç†
        await AsyncStorage.setItem('lastLogin', Date.now().toString());
      }
    } catch (error) {
      throw error;
    }
  }, [loginAction]);
  
  const logout = useCallback(async () => {
    try {
      await logoutAction();
      // æ¸…ç†å¹³å°ç‰¹å®šæ•°æ®
      if (Platform.OS === 'web') {
        localStorage.clear();
      } else {
        await AsyncStorage.clear();
      }
    } catch (error) {
      console.error('Logout error:', error);
    }
  }, [logoutAction]);
  
  return {
    user,
    token,
    isAuthenticated,
    loading,
    login,
    logout
  };
};
```

### 3.2 APIå±‚ç»Ÿä¸€

#### ğŸ”§ ç»Ÿä¸€APIå®¢æˆ·ç«¯
```javascript
// shared/api/client.js
import axios from 'axios';

const createApiClient = (baseURL) => {
  const client = axios.create({
    baseURL,
    timeout: 10000
  });
  
  // è¯·æ±‚æ‹¦æˆªå™¨
  client.interceptors.request.use(
    (config) => {
      const token = getToken(); // å¹³å°ç‰¹å®šçš„tokenè·å–
      if (token) {
        config.headers.Authorization = `Bearer ${token}`;
      }
      return config;
    },
    (error) => Promise.reject(error)
  );
  
  // å“åº”æ‹¦æˆªå™¨
  client.interceptors.response.use(
    (response) => response.data,
    (error) => {
      if (error.response?.status === 401) {
        // å¤„ç†è®¤è¯å¤±è´¥
        handleAuthError();
      }
      return Promise.reject(error);
    }
  );
  
  return client;
};

// APIæ–¹æ³•
export const authAPI = {
  login: (credentials) => client.post('/auth/login', credentials),
  register: (userData) => client.post('/auth/register', userData),
  refreshToken: () => client.post('/auth/refresh'),
  logout: () => client.post('/auth/logout')
};

export const userAPI = {
  getProfile: () => client.get('/users/profile'),
  updateProfile: (data) => client.put('/users/profile', data),
  getStudents: () => client.get('/users/students')
};
```

## 4. æµ‹è¯•ç­–ç•¥æ”¹è¿›

### 4.1 Webç«¯æµ‹è¯•å¢å¼º

#### ğŸ”§ ç»„ä»¶æµ‹è¯•
```javascript
// __tests__/components/DataTable.test.jsx
import { render, screen, fireEvent } from '@testing-library/react';
import { DataTable } from '../components/common/DataTable';

const mockData = [
  { id: 1, name: 'å¼ ä¸‰', age: 20 },
  { id: 2, name: 'æå››', age: 22 }
];

const mockColumns = [
  { title: 'å§“å', dataIndex: 'name', key: 'name' },
  { title: 'å¹´é¾„', dataIndex: 'age', key: 'age' }
];

describe('DataTable', () => {
  it('should render data correctly', () => {
    render(<DataTable data={mockData} columns={mockColumns} />);
    
    expect(screen.getByText('å¼ ä¸‰')).toBeInTheDocument();
    expect(screen.getByText('æå››')).toBeInTheDocument();
  });
  
  it('should handle row selection', () => {
    const onRowSelect = jest.fn();
    render(
      <DataTable 
        data={mockData} 
        columns={mockColumns} 
        onRowSelect={onRowSelect}
      />
    );
    
    const checkbox = screen.getAllByRole('checkbox')[1]; // ç¬¬ä¸€è¡Œçš„checkbox
    fireEvent.click(checkbox);
    
    expect(onRowSelect).toHaveBeenCalledWith([mockData[0]]);
  });
});
```

### 4.2 ç§»åŠ¨ç«¯æµ‹è¯•

#### ğŸ”§ ç§»åŠ¨ç«¯ç»„ä»¶æµ‹è¯•
```javascript
// __tests__/screens/Dashboard.test.js
import { render, fireEvent } from '@testing-library/react-native';
import { Dashboard } from '../src/screens/Dashboard';

// Mockå¯¼èˆª
const mockNavigation = {
  navigate: jest.fn(),
  goBack: jest.fn()
};

describe('Dashboard Screen', () => {
  beforeEach(() => {
    jest.clearAllMocks();
  });
  
  it('should render dashboard correctly', () => {
    const { getByText } = render(
      <Dashboard navigation={mockNavigation} />
    );
    
    expect(getByText('ä»ªè¡¨æ¿')).toBeTruthy();
  });
  
  it('should navigate to profile on button press', () => {
    const { getByTestId } = render(
      <Dashboard navigation={mockNavigation} />
    );
    
    const profileButton = getByTestId('profile-button');
    fireEvent.press(profileButton);
    
    expect(mockNavigation.navigate).toHaveBeenCalledWith('Profile');
  });
});
```

## 5. éƒ¨ç½²å’Œæ„å»ºä¼˜åŒ–

### 5.1 Webç«¯æ„å»ºä¼˜åŒ–

#### ğŸ”§ Webpackä¼˜åŒ–
```javascript
// å»ºè®®çš„webpacké…ç½®ä¼˜åŒ–
const path = require('path');
const { BundleAnalyzerPlugin } = require('webpack-bundle-analyzer');

module.exports = {
  // ä»£ç åˆ†å‰²
  optimization: {
    splitChunks: {
      chunks: 'all',
      cacheGroups: {
        vendor: {
          test: /[\\/]node_modules[\\/]/,
          name: 'vendors',
          chunks: 'all'
        },
        antd: {
          test: /[\\/]node_modules[\\/]antd[\\/]/,
          name: 'antd',
          chunks: 'all'
        }
      }
    }
  },
  
  // æ€§èƒ½é¢„ç®—
  performance: {
    maxAssetSize: 250000,
    maxEntrypointSize: 250000,
    hints: 'warning'
  },
  
  // æ’ä»¶
  plugins: [
    process.env.ANALYZE && new BundleAnalyzerPlugin()
  ].filter(Boolean)
};
```

### 5.2 ç§»åŠ¨ç«¯æ„å»ºä¼˜åŒ–

#### ğŸ”§ Expoé…ç½®ä¼˜åŒ–
```json
// app.json ä¼˜åŒ–é…ç½®
{
  "expo": {
    "name": "å­¦ä¹ è¿½è¸ªç³»ç»Ÿ",
    "slug": "learning-tracker",
    "version": "1.0.0",
    "orientation": "portrait",
    "icon": "./assets/icon.png",
    "splash": {
      "image": "./assets/splash.png",
      "resizeMode": "contain",
      "backgroundColor": "#ffffff"
    },
    "updates": {
      "fallbackToCacheTimeout": 0
    },
    "assetBundlePatterns": [
      "**/*"
    ],
    "ios": {
      "supportsTablet": true,
      "bundleIdentifier": "com.company.learningtracker"
    },
    "android": {
      "adaptiveIcon": {
        "foregroundImage": "./assets/adaptive-icon.png",
        "backgroundColor": "#FFFFFF"
      },
      "package": "com.company.learningtracker"
    },
    "web": {
      "favicon": "./assets/favicon.png"
    },
    "plugins": [
      "expo-font",
      "expo-splash-screen"
    ]
  }
}
```

## 6. æ€»ç»“å’Œæ”¹è¿›è®¡åˆ’

### 6.1 å‰ç«¯æ•´ä½“è¯„ä¼°

#### âœ… ä¼˜åŠ¿æ€»ç»“
1. **æŠ€æœ¯æ ˆç°ä»£åŒ–**: React 18, ç°ä»£åŒ–UIåº“
2. **æ¶æ„è®¾è®¡åˆç†**: ç»„ä»¶åŒ–ç¨‹åº¦é«˜ï¼ŒèŒè´£åˆ†ç¦»æ¸…æ™°
3. **è·¨å¹³å°æ”¯æŒ**: Webå’Œç§»åŠ¨ç«¯æŠ€æœ¯æ ˆç»Ÿä¸€
4. **çŠ¶æ€ç®¡ç†**: ä½¿ç”¨è½»é‡çº§Zustandï¼Œé¿å…è¿‡åº¦å¤æ‚
5. **å®æ—¶åŠŸèƒ½**: WebSocketæ”¯æŒå®æ—¶æ•°æ®æ›´æ–°

#### âš ï¸ ä¸»è¦é—®é¢˜
1. **ç±»å‹å®‰å…¨**: ç¼ºä¹TypeScriptç±»å‹æ£€æŸ¥
2. **æ€§èƒ½ä¼˜åŒ–**: ä»£ç åˆ†å‰²ã€æ‡’åŠ è½½ä¸è¶³
3. **æµ‹è¯•è¦†ç›–**: ç»„ä»¶æµ‹è¯•å’ŒE2Eæµ‹è¯•ä¸å®Œå–„
4. **é”™è¯¯å¤„ç†**: ç¼ºä¹ç»Ÿä¸€çš„é”™è¯¯è¾¹ç•Œå’Œå¤„ç†æœºåˆ¶
5. **ç›‘æ§ä½“ç³»**: ç¼ºä¹å‰ç«¯æ€§èƒ½ç›‘æ§å’Œé”™è¯¯è¿½è¸ª

### 6.2 æ”¹è¿›ä¼˜å…ˆçº§

#### ğŸ”´ é«˜ä¼˜å…ˆçº§ (1-2å‘¨)
1. **TypeScriptè¿ç§»**: é€æ­¥å¼•å…¥ç±»å‹æ£€æŸ¥
2. **é”™è¯¯è¾¹ç•Œ**: å®ç°ç»Ÿä¸€é”™è¯¯å¤„ç†
3. **æ€§èƒ½ä¼˜åŒ–**: ä»£ç åˆ†å‰²å’Œæ‡’åŠ è½½
4. **æµ‹è¯•å¢å¼º**: è¡¥å……å…³é”®ç»„ä»¶æµ‹è¯•

#### ğŸŸ¡ ä¸­ä¼˜å…ˆçº§ (2-4å‘¨)
1. **ç›‘æ§é›†æˆ**: å‰ç«¯æ€§èƒ½ç›‘æ§å’Œé”™è¯¯è¿½è¸ª
2. **PWAæ”¯æŒ**: Webç«¯PWAåŠŸèƒ½
3. **æ— éšœç¢è®¿é—®**: æå‡å¯è®¿é—®æ€§
4. **å›½é™…åŒ–**: å¤šè¯­è¨€æ”¯æŒ

#### ğŸŸ¢ ä½ä¼˜å…ˆçº§ (1-2ä¸ªæœˆ)
1. **ä¸»é¢˜ç³»ç»Ÿ**: å¯å®šåˆ¶ä¸»é¢˜
2. **ç¦»çº¿å¢å¼º**: æ›´å®Œå–„çš„ç¦»çº¿åŠŸèƒ½
3. **åŠ¨ç”»ä¼˜åŒ–**: æå‡ç”¨æˆ·ä½“éªŒ
4. **å¾®å‰ç«¯**: è€ƒè™‘å¾®å‰ç«¯æ¶æ„

### 6.3 æŠ€æœ¯å€ºåŠ¡è¯„ä¼°

| å€ºåŠ¡ç±»å‹ | ä¸¥é‡ç¨‹åº¦ | å½±å“èŒƒå›´ | ä¿®å¤æ—¶é—´ |
|---------|---------|----------|----------|
| TypeScriptç¼ºå¤± | é«˜ | å…¨é¡¹ç›® | 3-4å‘¨ |
| æ€§èƒ½ä¼˜åŒ– | ä¸­ | ç”¨æˆ·ä½“éªŒ | 2-3å‘¨ |
| æµ‹è¯•è¦†ç›– | ä¸­ | ä»£ç è´¨é‡ | 2-3å‘¨ |
| é”™è¯¯å¤„ç† | ä¸­ | ç¨³å®šæ€§ | 1-2å‘¨ |
| ç›‘æ§ä½“ç³» | ä½ | è¿ç»´ | 1-2å‘¨ |

### 6.4 å®æ–½å»ºè®®

1. **æ¸è¿›å¼æ”¹è¿›**: é¿å…å¤§è§„æ¨¡é‡æ„ï¼Œé‡‡ç”¨æ¸è¿›å¼æ”¹è¿›
2. **å‘åå…¼å®¹**: ç¡®ä¿æ”¹è¿›è¿‡ç¨‹ä¸­çš„å‘åå…¼å®¹æ€§
3. **æ€§èƒ½åŸºå‡†**: å»ºç«‹æ€§èƒ½åŸºå‡†æµ‹è¯•ï¼Œç›‘æ§æ”¹è¿›æ•ˆæœ
4. **ç”¨æˆ·åé¦ˆ**: æ”¶é›†ç”¨æˆ·åé¦ˆï¼Œä¼˜å…ˆè§£å†³å½±å“ç”¨æˆ·ä½“éªŒçš„é—®é¢˜
5. **å›¢é˜ŸåŸ¹è®­**: å¯¹æ–°æŠ€æœ¯å’Œæœ€ä½³å®è·µè¿›è¡Œå›¢é˜ŸåŸ¹è®­

---

**è¯„å®¡å®Œæˆ**: 2024å¹´12æœˆ  
**æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**ä¸‹æ¬¡è¯„å®¡**: æ”¹è¿›å®Œæˆåè¿›è¡Œå¤å®¡