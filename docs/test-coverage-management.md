# Test Coverage File Management

This document explains how to manage temporary files generated by test coverage tools to prevent them from being committed to the Git repository.

## Configured Ignore Rules

We have configured the following files to ignore test coverage-related files:

1. **Root `.gitignore`**:
   - Added coverage report directories and files
   - Added Jest cache and temporary files
   - Added test result reports

2. **Test directory-specific `.gitignore`**:
   - `backend/__tests__/.gitignore`
   - `backend/services/user-service/test/.gitignore`

3. **`.gitattributes`**:
   - Marked coverage reports as generated files, excluded from language statistics

## Cleanup Script

We provide a cleanup script to delete all test coverage-related temporary files:

```bash
npm run clean:coverage
```

This command executes the `scripts/clean-coverage.sh` script, which deletes the following files and directories:

- `coverage/` directory
- `__coverage__/` directory
- `.coverage/` directory
- `reports/` directory
- `junit/` directory
- `.nyc_output/` directory
- `*.lcov` files
- `clover.xml` files
- `coverage-final.json` files
- `coverage-summary.json` files
- `jest-junit.xml` files
- `jest-*.json` files
- `.jest-cache/` directory
- `.jest-*` files

## Pre-commit Cleanup

We have configured a `precommit` hook that automatically runs the cleanup script before committing code:

```json
"precommit": "npm run clean:coverage"
```

This ensures that coverage files are not accidentally committed to the repository.

## Testing Without Coverage Reports

If you want to run tests without generating coverage reports, you can use the following command:

```bash
npm run test:nocoverage
```

This command runs tests without generating coverage reports, thus avoiding the creation of temporary files.

## Manual Cleanup

If you need to manually clean up coverage files, you can run:

```bash
./scripts/clean-coverage.sh
```

Or use the npm script:

```bash
npm run clean:coverage
```

## Finding Coverage Files

If you want to find all coverage files in the project, you can run:

```bash
npm run find:coverage
```

This command will list all coverage-related files in the project, helping you determine which files need to be removed from Git.

## Removing Already Committed Coverage Files from Git

If you have already committed coverage files to the Git repository, you can use the following command to remove them from the repository (while keeping the local files):

```bash
npm run remove:coverage-git
```

This command executes the `scripts/remove-coverage-from-git.sh` script, which removes coverage files from the Git index. After execution, you need to commit this change and push it to the remote repository:

```bash
git commit -m "Remove test coverage intermediate files"
git push origin <branch-name>
```

This ensures that coverage files do not appear in the Git repository while preserving local files.
